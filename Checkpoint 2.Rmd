---
title: "Checkpoint 2"
output: html_document
---
```{r setup, include=FALSE}
# General set-up for the report.
# I find this useful, but you may improve upon, ignore, or remove
#  (possibly at your own peril).
# Tasks accomplished:
# Don't print out code
# Save results so that code blocks aren't re-run unless code
# changes (cache), _or_ a relevant earlier code block changed (autodep),
# don't clutter R output with messages or warnings (message, warning)
library(MASS)
library(knitr)
library(tidyverse)
library(dplyr)
library(ggthemes)
library(gridExtra)
library(ggplot2)
opts_chunk$set(echo=FALSE,
               cache=TRUE, autodep=TRUE,
               message=FALSE, warning=FALSE)
# Turn off meaningless clutter in summary() output
options(show.signif.stars=FALSE)
```

##If a Hoosier drops a pass in the end zone, but there's no one there to see it, did it ever really happen?

We are interested in finding out what motivates a person to dedicate a large chunk of their Saturday to attending a college football game. The conclusions that can be learned by analyzing this dataset have uses beyond just predicting future college football attendance. They can also be used, with much care, to understand the decisions people make when attending other events, athletic and non-athletic. Another reason why this dataset is interesting to our team is that it allows us to relate to behavior we have observed in our own college experiences, such as in game days during the day or at night and the influence of the weather.

# I. Introduction

```{r load-data, include=FALSE}
attendance.data = read.csv("CFBeattendance.csv")
newtime = str_split(attendance.data$Time, ":")
```

The data analyzed contains information from American College Division 1 Football games spanning 2000 to 2018. The data is specifically the home games for the selected teams, with the corresponding attendance rates for the stadium played in. There are 63 teams recorded, totaling 6672 home games. The columns selected include date of the game, the home team, the opponent, time of game, rank of both teams, whether the game was televised, the result of the game, stadium capacity and fill rate, whether there is a new coach, as well as the weather metrics during the game (precipitation, snow, temperature maximum and minimum). 

What are the relationships between the predictors and attendance? Weâ€™re looking at the relationships with attendance over the course of one season as well as over the many seasons in the sample. Have these relationships changed over time? For example, are there some predictors that had a stronger relationship earlier in the sample? How do different predictors relate to each other and interact in their relationships with attendance?


# II. Exploratory Data Analysis

## A. Exploring the Variables

```{r quantile ranges}
quantile(attendance.data$Attendance, c(0.25, 0.5, 0.75), type = 1, na.rm = TRUE)
quantile(attendance.data$Stadium.Capacity, c(0.25, 0.5, 0.75), type = 1, na.rm = TRUE)
```

```{r response-histograms}
par(mfrow = c(3,3))
hist(attendance.data$Attendance/1000, breaks = 24,
     main = "Histogram of Attendance")
hist(attendance.data$Fill.Rate, main = "Histogram of Fill Rate")
hist(attendance.data$Current.Wins, main = "Histogram of Current Wins")
hist(attendance.data$Current.Losses, main = "Histogram of Current Losses")
hist(attendance.data$Stadium.Capacity, main = "Histogram of Stadium Capacity")
hist(attendance.data$Year, main = "Histogram of Year")
hist(attendance.data$Month, main = "Histogram of Month")
```

In order to understand the data provided, the variables were first analyzed in histograms. Attendance is distributed fairly evenly with most of the game attendance between 20,000 and 62,000. Fill rate sometimes exceeds 100% when some stadiums are over capacity, but there is a skew to the left. The current wins and losses both are skewed to the right, with most at 0-2. Stadium capactity is seemingly distributed evenly throughout, with some peaks at different points. From 2000-2018, there are even amounts of data points for the home games, making is easier to observe trends in the given time frame. Regarding the months recorded, the games are all in the fall during the main college football season. The games that were played in the spring were removed in order to have consistent analysis of the data. 

```{r bad-data-removal}
attendance.data = attendance.data[-c(5436,5443,5450,5457, 4522, 4524, 4526, 4528, 4530, 4532),]
```

```{r incorrect-data}
attendance.data[4424, 24] = 12

attendance.data$Conference[which(attendance.data$Team=="Oregon State")] = "Pac-12"

attendance.data$Conference[which(attendance.data$Team=="USC")] = "Pac-12"

rutgers = attendance.data[which(attendance.data$Team=="Rutgers"),]
yr = 2000
while(yr<2013){
        rutgers$Conference[which(rutgers$Year==yr)] = "Big East"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="Rutgers")] = rutgers$Conference

boston_college = attendance.data[which(attendance.data$Team=="Boston College"),]
yr = 2000
while(yr<2005){
        boston_college$Conference[which(boston_college$Year==yr)] = "Big East"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="Boston College")] = boston_college$Conference

smu = attendance.data[which(attendance.data$Team=="SMU"),]
yr = 2005
while(yr<2013){
        smu$Conference[which(smu$Year==yr)] = "CUSA"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="SMU")] = smu$Conference

south_alabama = attendance.data[which(attendance.data$Team=="South Alabama"),]
yr = 2013
while(yr<2019){
        south_alabama$Conference[which(south_alabama$Year==yr)] = "Sun Belt"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="South Alabama")] = south_alabama$Conference

west_virginia = attendance.data[which(attendance.data$Team=="West Virginia"),]
yr = 2000
while(yr<2012){
        west_virginia$Conference[which(west_virginia$Year==yr)] = "Big East"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="West Virginia")] = west_virginia$Conference

memphis = attendance.data[which(attendance.data$Team=="Memphis"),]
memphis$Conference[which(memphis$Year==2013)] = "AAC"
attendance.data$Conference[which(attendance.data$Team=="Memphis")] = memphis$Conference

mid_tennessee = attendance.data[which(attendance.data$Team=="Middle Tennessee"),]
mid_tennessee$Conference[which(mid_tennessee$Year==2001)] = "Sun Belt"
attendance.data$Conference[which(attendance.data$Team=="Middle Tennessee")] = mid_tennessee$Conference

byu = attendance.data[which(attendance.data$Team=="BYU"),]
byu$Conference[which(byu$Year==2011)] = "Independent"
attendance.data$Conference[which(attendance.data$Team=="BYU")] = byu$Conference

fiu = attendance.data[which(attendance.data$Team=="FIU"),]
yr = 2002
while(yr<2005){
        fiu$Conference[which(fiu$Year==yr)] = "FCS"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="FIU")] = fiu$Conference

georgia_st = attendance.data[which(attendance.data$Team=="Georgia State"),]
yr = 2011
while(yr<2013){
        georgia_st$Conference[which(georgia_st$Year==yr)] = "FCS"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="Georgia State")] = georgia_st$Conference
```

In the data set, there were multiple teams that were placed into the wrong conferences at certain points in time. The data was fixed to correct this issue. 


## B. Continouous Predictors

### 1. Plots

```{r pairs-plot}
pairs(Attendance~TMAX+TMIN+SNOW+PRCP+SNWD, data=attendance.data) #weather
```
**Since the data are cummulated over years, it is good to see the relationships between each year of attendance and other factors. 

```{r}
TemMax <- ggplot(attendance.data, aes(x=TMAX, y=Attendance/1000)) + geom_point()
TemMax + facet_grid(attendance.data$Year)
TemMin <- ggplot(attendance.data, aes(x=TMIN, y=Attendance/1000)) + geom_point()
TemMin + facet_grid(attendance.data$Year)
```

### 2. Analysis

## C. Discrete Predictors

### 1. Plots

```{r discrete-boxplots}

boxplot(Attendance/1000~Tailgating,data=attendance.data,
        main = "Attendance (Thousands) vs Tailgating")
boxplot(Attendance/1000~New.Coach,data=attendance.data,
        main = "Attendance (Thousands) vs New Coach")
boxplot(Attendance/1000~Current.Wins,data=attendance.data,
        main = "Attendance (Thousands) vs Wins")
boxplot(Attendance/1000~Current.Losses,data=attendance.data,
        main = "Attendance (Thousands) vs Losses")
boxplot(Attendance/1000~Year, notch=FALSE, varwidth=FALSE, data=attendance.data,
        main = "Attendance (Thousands) vs Year")
boxplot(Attendance/1000~Month,data=attendance.data,
        main = "Attendance (Thousands) vs Month")

boxplot(Fill.Rate~Tailgating,data=attendance.data,
        main = "Fill Rate vs Tailgating")
boxplot(Fill.Rate~New.Coach,data=attendance.data,
        main = "Fill Rate (Thousands) vs New Coach")
boxplot(Fill.Rate~Current.Wins,data=attendance.data,
        main = "Fill Rate vs Wins")
boxplot(Fill.Rate~Current.Losses,data=attendance.data,
        main = "Fill Rate vs Losses")
boxplot(Fill.Rate~Year, notch=FALSE, varwidth=FALSE, data=attendance.data,
        main = "Fill Rate vs Year")
boxplot(Fill.Rate~Month,data=attendance.data,
        main = "Fill Rate vs Month")
```

### 2. Analysis
