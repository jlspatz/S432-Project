---
title: "If a Hoosier drops a pass in the end zone, but there's no one there to see it, did it ever really happen?"
output: html_document
---
```{r setup, include=FALSE}
# General set-up for the report.
# I find this useful, but you may improve upon, ignore, or remove
#  (possibly at your own peril).
# Tasks accomplished:
# Don't print out code
# Save results so that code blocks aren't re-run unless code
# changes (cache), _or_ a relevant earlier code block changed (autodep),
# don't clutter R output with messages or warnings (message, warning)
library(MASS)
library(knitr)
library(tidyverse)
library(dplyr)
library(ggthemes)
library(gridExtra)
library(ggplot2)
opts_chunk$set(echo=FALSE,
               cache=TRUE, autodep=TRUE,
               message=FALSE, warning=FALSE)
# Turn off meaningless clutter in summary() output
options(show.signif.stars=FALSE)
```

# By: Jordan Majoros, Minwoo Lee, Lester Blumberg, and Joseph Spatz

As the Summer comes to a conclusion and the leaves start to change, excitement begins to grow on college campuses. After a few weeks into the fall semester, college football returns with optimistic fans eager to watch their school compete. Fans travel long distances to come back to their alma maters. The teams schedule has been examined to choose the best game to attend, whether it be the homecoming game, a top 10 opponent, or a rivalry game. Fans begin flooding campuses on Friday night or they awake early with excitement and drive the morning of the game. Almost all division one schools have big tailgating scenes hours before kickoff. Bands and cheer teams perform school traditions to build school spirit before entering the stadium. Most fans will then enter the stadium, some going in early to watch warm-ups and others right before kickoff. Their are many aspects to a college football game that draw fans to want to be in attendance. The analysis that follows will examine the different variables surrounding a college football game and see what kind of correlation they have with the number of people attending the game. We are interested in finding out what motivates a person to dedicate a large chunk of their Saturday to attending a college football game. The conclusions that can come from analyzing this dataset have uses beyond just predicting future college football attendance. They can also be used, with much care, to understand the decisions people make when attending other events, athletic and non-athletic. Another reason why this dataset is interesting to our team is that we can relate our findings to behavior we have observed in our own college experiences.

# I. Introduction

```{r load-data, include=FALSE}
attendance.data = read.csv("CFBeattendance.csv")
newtime = str_split(attendance.data$Time, ":")
```

The data analyzed contains information primarily from NCAA FBS (Football Bowl Subdivision), and its Division I-A predecessor, College Football games spanning 2000 to 2018. The data is specifically the home games for the selected teams, with the corresponding attendance rates for the stadium played in. Some of the teams in the dataset have seasons included before they had reached the FBS level. For classification purposes, we list all of these teams' conferences as being FCS for those seasons. There are `r length(levels(attendance.data$Team))` teams recorded, totaling 6672 home games. The columns selected include date of the game, the home team, the opponent, time of game, rank of both teams, whether the game was televised, the result of the game, stadium capacity and fill rate, whether there is a new coach, as well as the weather metrics during the game (precipitation, snowfall, snow depth, temperature maximum, and temperature minimum). 

We are trying to determine the relationships between the variables and attendance? Weâ€™re looking at the relationships with attendance over the course of one season as well as over the many seasons in the sample. Have these relationships changed over time? For example, are there some predictors that had a stronger relationship earlier in the sample? How do different predictors relate to each other and interact in their relationships with attendance?


# II. Exploratory Data Analysis
## A. Exploring the Variables

| Variable | Description |
|:------------------------------------------------|:-------------------------------------------------------------------------------------------------------|
| Team | Name of college football team |
| Time | Start time of game |
| Opponent | Name of college team that given college is playing |
| Rank | Age of contestant |
| Site | Location of game |
| TV | Television station game is broadcasted |
| Result | Final result of game with win or loss  and score |
| Attendance | Number of fans in attendance |
| Current.Wins | Number of season wins going into given game |
| Current.Losses | Number of season losses going into given game |
| Stadium.Capacity | Maximum number of fans given teams stadium can hold |
| Fill.Rate | Proportion of stadium capacity filled |
| New.Coach | Does team have a first year coach? TRUE or FALSE |
| Tailgating | Is the college rated a top 25 tailgating scene? TRUE or FALSE |
| PRCP | Amount of precipitation during game |
| SNOW | Amount of snowfall during game |
| SNWD | Depth of snow during play |
| TMAX | Maximum temperature during game |
| TMIN | Minimum temperature during game |
| Opponent_Rank | Number rank of opponent team if in top 25, NR if not |
| Conference | Division team plays in |
| Year | Year of recorded game |
| Month | Month of recorded game |
| Day | Day of recorded game |

### 1. Quantiles

```{r quantile ranges}
quan.att = quantile(attendance.data$Attendance, c(0.25, 0.5, 0.75), type = 1, na.rm = TRUE)
quan.fill = quantile(attendance.data$Fill.Rate, c(0.25, 0.5, 0.75), type = 1, na.rm = TRUE)
quan.cap = quantile(attendance.data$Stadium.Capacity, c(0.25, 0.5, 0.75), type = 1, na.rm = TRUE)
quan.att
quan.cap
quan.fill
```

The median for attendance is `r quan.att[2]`, with 25% and 75% quantiles of `r quan.att[1]` and `r quan.att[3]`. For stadium capacity, we have a median of `r quan.cap[2]` and quantiles of `r quan.cap[1]` and `r quan.cap[3]`. Fill rate has a median of `r quan.fill[2]`, a 25% quantile of `r quan.fill[1]`, and a 75% quantile of `r quan.fill[3]`.

```{r bad-data-removal}
attendance.data = attendance.data[-c(5436,5443,5450,5457, 4522, 4524, 4526, 4528, 4530, 4532),]
```

```{r incorrect-data}
attendance.data[4424, 24] = 12

attendance.data$Conference[which(attendance.data$Team=="Oregon State")] = "Pac-12"

attendance.data$Conference[which(attendance.data$Team=="USC")] = "Pac-12"

rutgers = attendance.data[which(attendance.data$Team=="Rutgers"),]
yr = 2000
while(yr<2013){
        rutgers$Conference[which(rutgers$Year==yr)] = "Big East"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="Rutgers")] = rutgers$Conference

boston_college = attendance.data[which(attendance.data$Team=="Boston College"),]
yr = 2000
while(yr<2005){
        boston_college$Conference[which(boston_college$Year==yr)] = "Big East"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="Boston College")] = boston_college$Conference

smu = attendance.data[which(attendance.data$Team=="SMU"),]
yr = 2005
while(yr<2013){
        smu$Conference[which(smu$Year==yr)] = "CUSA"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="SMU")] = smu$Conference

south_alabama = attendance.data[which(attendance.data$Team=="South Alabama"),]
yr = 2013
while(yr<2019){
        south_alabama$Conference[which(south_alabama$Year==yr)] = "Sun Belt"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="South Alabama")] = south_alabama$Conference

west_virginia = attendance.data[which(attendance.data$Team=="West Virginia"),]
yr = 2000
while(yr<2012){
        west_virginia$Conference[which(west_virginia$Year==yr)] = "Big East"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="West Virginia")] = west_virginia$Conference

memphis = attendance.data[which(attendance.data$Team=="Memphis"),]
memphis$Conference[which(memphis$Year==2013)] = "AAC"
attendance.data$Conference[which(attendance.data$Team=="Memphis")] = memphis$Conference

mid_tennessee = attendance.data[which(attendance.data$Team=="Middle Tennessee"),]
mid_tennessee$Conference[which(mid_tennessee$Year==2001)] = "Sun Belt"
attendance.data$Conference[which(attendance.data$Team=="Middle Tennessee")] = mid_tennessee$Conference

byu = attendance.data[which(attendance.data$Team=="BYU"),]
byu$Conference[which(byu$Year==2011)] = "Independent"
attendance.data$Conference[which(attendance.data$Team=="BYU")] = byu$Conference

fiu = attendance.data[which(attendance.data$Team=="FIU"),]
yr = 2002
while(yr<2005){
        fiu$Conference[which(fiu$Year==yr)] = "FCS"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="FIU")] = fiu$Conference

georgia_st = attendance.data[which(attendance.data$Team=="Georgia State"),]
yr = 2011
while(yr<2013){
        georgia_st$Conference[which(georgia_st$Year==yr)] = "FCS"
        yr = yr+1
}
attendance.data$Conference[which(attendance.data$Team=="Georgia State")] = georgia_st$Conference
```

